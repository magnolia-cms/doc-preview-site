---
title: "Multi JCR block"
url: https://docs.magnolia-cms.com/product-docs/6.3/Modules/List-of-modules/Content-Editor-module/Multi-JCR-block/
category: Magnolia 6.3
version: 6.3
breadcrumb: DX Core > Modules > Content Editor module > Multi JCR block
---

# Multi JCR block

info.magnolia.editor.block.jcr.MultiJcrBlockDefinition is a special type of [multi field](../../../../../RNs-6-4-3/Developing/Templating/Dialog-definition/Field-definition/List-of-fields/Multi-field/) installed by the [Content Editor module](../../../../../RNs-6-4-3/Modules/List-of-modules/Content-Editor-module/). It enables different block types in a content editor, for example the [Stories app](../../../../Apps/List-of-apps/Stories-app/), and allows you to change their appearance.

> **Important:** Keep in mind that multiJcrBlock is a content-editor field and therefore can’t be used in a content-type app.

> **Note:** By specifying the $type as multiJcrBlock, or alternatively the class as info.magnolia.editor.block.jcr.MultiJcrBlockDefinition, several configuration properties are set automatically:implementationClass is set to info.magnolia.editor.block.MultiBlockViewentryResolution is set to MultiJcrBlockEntryResolutionorderHandler is set to MultiJcrBlockOrderHandler

## [](#_example_definition)Example definition

```yml
blocks:
  label: Blocks
  $type: multiJcrBlock
  initialBlock: text
  defaultBlock: image
  blocks:
    - text
    - image
    - video
    - externalLink
  itemProvider:
    $type: currentItemProvider
```

| Property | Description |
| --- | --- |
| `blocks` | **required** Node containing a list of block definitions. |
| `defaultBlock` | **required** The name of the block which will be pre-selected in the block picker subdialog. |
| `initialBlock` | **required** The name of the block that will be created as the initial block when creating a new content item (new story). |

## [](#_content_i18n_and_migration_to_version_2_1_and_higher)Content i18n and migration to version 2.1 (and higher)

[Internationalization](../../../../Administration/Language/Internationalization/) (i18n) of content is supported since version `2.1` of the Content Editor module.

If you are upgrading from Magnolia 6.2 or from a 1.x version of the Content Editor, please mind the migration procedures below to enable i18n in the Stories app, as well as in other Content Editor based apps you may have.

### [](#_compatibility_of_content_and_block_definitions)Compatibility of content and block definitions

Block definitions and data structures created in the older versions of the module must be migrated.

#### [](#_flat_vs_nested_content_structure)Flat vs nested content structure

The data model has changed for internationalized stories. Whereas in versions `1.3.x` and `2.0.x` of the module, the `mgnl:block` elements are stored in a flat node structure,

stories
└── story1
    ├── 0
    └── 1

in the i18n-supported version (`2.1` and higher), the nodes are locale-nested under intermediate nodes of type `mgnl:contentNode`, named `blocks_de` and `blocks` in this example:

stories
└── story1
    └── blocks\_de
    │   ├── 0\_de
    │   └── 1\_de
    └── blocks
        ├── 0
        └── 1

This must be reflected in your `[MultiJcrBlockDefinition](./)`, where you need to add and enable the `i18n` property.

Instead of the `CurrentItemProvider`, the `CompatibleBlockProvider` is set as the default provider, which can resolve both flat and nested block nodes. You do not need to declare it in your block definition.

Example definition

```yml
blocks:
  label: Blocks
  $type: multiJcrBlock
  i18n: true
  blocks:
    - text
```

> **Note:** This applies only to the 2.0.x block definitions. Block definitions created for version 1.3.x (5 UI) of the module are not compatible with the 2.1 version and must be fully migrated.

#### [](#_migrating_content)Migrating content

There are two ways you can migrate the non-i18n blocks to the i18n-compatible hierarchy: using a version handler or a Groovy script.

> **Caution:** We strongly recommend you have the latest version of the Content Editor before migrating your content.In versions prior to 2.1.3, the MigrateBlockToIntermediateParentTask doesn’t preserve the order of nodes when migrating to the latest version. Running this task can actually reorder the nodes to an incorrect state.

##### [](#_version_handler)Version handler

When upgrading the Stories app submodule to version `2.1` or higher, all block nodes in the `stories` workspace will be moved to intermediate nodes, see the `MigrateBlockToIntermediateParentTask` task.

##### [](#_groovy_script)Groovy script

You can run the migration task in the [Groovy app](../../../../Apps/List-of-apps/Groovy-app/), especially in case a block node is stored in another workspace.

Example Groovy script

```groovy
import info.magnolia.editor.setup.MigrateBlockToIntermediateParentTask
import info.magnolia.module.InstallContextImpl
import info.magnolia.module.ModuleRegistryImpl
import info.magnolia.objectfactory.Components
import javax.jcr.Session


Session session =  MgnlContext.getJCRSession("stories");
task = new MigrateBlockToIntermediateParentTask("stories", "/", "blocks");
task.execute(Components.newInstance(InstallContextImpl.class));
session.save();
```

The parameters in the `MigrateBlockToIntermediateParentTask`:

-   `stories` - workspace name

-   `/` - path

-   `blocks` - name of the intermediate node, the name of the `multiJcrBlock` field.
