---
title: "Magnolia home persistent volume is almost full"
url: https://docs.magnolia-cms.com/paas/troubleshooting/alerts/CustomerMagnoliaHomePersistentVolumeAlmostFull/
category: DX Cloud
version: cloud
breadcrumb: DX Cloud > Troubleshoot > Magnolia home persistent volume is almost full
---

# Magnolia home persistent volume is almost full

## [](#_symptom)Symptom

A `CustomerMagnoliaHomePersistentVolumeAlmostFull` alert is firing

> **Note:** CustomerMagnoliaHomePersistentVolumeAlmostFull alerts are sent to subscribers via email.

## [](#_observations)Observations

Here are the details on the alerts:

### [](#_alert_customermagnoliahomepersistentvolumealmostfull)Alert: CustomerMagnoliaHomePersistentVolumeAlmostFull

<div class="joplin-table-wrapper"><table class="tableblock frame-all grid-all stretch"><colgroup><col style="width: 30%;"> <col style="width: 70%;"></colgroup><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Expression</strong></p></td><td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph"><p><code>(kubelet_volume_stats_available_bytes{persistentvolumeclaim=~"magnolia-home.*"} / kubelet_volume_stats_capacity_bytes{persistentvolumeclaim=~"magnolia-home.*"}) * 100 &lt; 10</code></p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Delay</strong></p></td><td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph"><p><code>10</code> minutes</p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Labels</strong></p></td><td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph"><p><code>team: customer</code></p></div></div></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Annotations</strong></p></td><td class="tableblock halign-left valign-top"><div class="content"><div class="ulist"><ul><li><p><code>summary</code></p></li><li><p><code>description</code></p></li><li><p><code>tenant</code></p></li><li><p><code>cluster_id</code></p></li><li><p><code>cluster_name</code></p></li><li><p><code>namespace</code></p></li><li><p><code>pvc</code></p></li></ul></div></div></td></tr></tbody></table></div>

### [](#_determine_current_size_of_magnolia_home_persistent_volume)Determine current size of Magnolia home persistent volume

The name of the persistent volume claim and its namespace are contained in the alert, for example "database-prod-magnolia-helm-public-db-0".

You can find the details on the persistent volume by displaying the persistent volume claim using kubectl:

```bash
kubectl -n <namespace from alert> get pvc <persistent volume claim from alert>
```

Executing the above will list the size of the persistent volume:

```bash
$ kubectl -n prod get pvc magnolia-home-prod-magnolia-helm-public-0
NAME                                        STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE
magnolia-home-prod-magnolia-helm-public-0   Bound    pvc-30bb25b4-289f-4029-946e-29197a5aea44   10Gi       RWO            gp2            228d
```

> **Note:** The value is listed in the CAPACITY column.

## [](#_solutions)Solutions

This section provides a solution that should help resolve the issue in most cases.

1.  [Increase the capacity of the persistent volume](#_increase_the_capacity_of_the_persistent_volume)

2.  [Increase capacity via Helm chart](#_increase_capacity_via_helm_chart)

3.  [Delete the `StatefulSet`](#_delete_the_statefulset)


### [](#_increase_the_capacity_of_the_persistent_volume)Increase the capacity of the persistent volume

The space allocated to the persistent volume can be increased by editing the persistent volume in Rancher and by [modifying the values of the Helm chart](#_increase_capacity_via_helm_chart) deploying Magnolia.

You can edit the persistent volume claim and increase the capacity in Rancher or with `kubectl`.

Edit the persistent volume claim or the persistent volume associated with the claim and increase the size of the storage resource.

1.  Get your desired namespace.

    ```sh
    kubectl -n <namespace> get pvc <pvc-name>
    ```

2.  Edit the PVC.

    ```sh
    kubectl -n <namespace> edit pvc <pvc-name>
    ```

3.  In the editor, adjust the `storage`.

    ```yaml
      resources:
        requests:
          storage: 10Gi (1)
    ```

    |     |     |
    | --- | --- |
    | **1** | Increase the `storage` property. |

    > **Warning:** The storage resource for the persistent volume claim is not permanent. It may be overridden when Magnolia is redeployed with the Helm chart.


### [](#_increase_capacity_via_helm_chart)Increase capacity via Helm chart

1.  Set the Helm chart value `magnoliaPublic.persistence.size` to an appropriate value.

    *The default value of `magnoliaPublic.persistence.size` is `10Gi`.*

2.  Redeploy Magnolia.


### [](#_delete_the_statefulset)Delete the `StatefulSet`

Because `StatefulSet` volume definitions cannot be updated in place, you must manually update them.

1.  Run the `kubectl` command to delete the statefulset.

    ```none
    kubectl delete statefulset <name> --cascade=orphan (1)
    ```

    |     |     |
    | --- | --- |
    | **1** | **Important**: The `--cascade=orphan` flag ensures running pods are not deleted. |

2.  Redeploy Magnolia.
