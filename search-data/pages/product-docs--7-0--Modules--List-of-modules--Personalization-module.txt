---
title: "Personalization module"
url: https://docs.magnolia-cms.com/product-docs/7.0/Modules/List-of-modules/Personalization-module/
category: Magnolia 6.4
version: latest
breadcrumb: DX Core > Modules > Personalization module
---

# Personalization module

[Personalization](../../../use-cases/Personalization/) Bundled: DX Core

| Edition | DX Core |
| --- | --- |
| License | [MLA](https://www.magnolia-cms.com/mla.html)<br><br>This module includes GeoLite2 data created by MaxMind, available from [www.maxmind.com](https://www.maxmind.com). |
| Issues | [MGNLPN](https://magnolia-cms.atlassian.net/browse/MGNLPN) |
| Maven site | [Personalization](https://nexus.magnolia-cms.com/#browse/browse:enterprise:info%2Fmagnolia%2Fpersonalization%2Fmagnolia-personalization-integration%2F4.0.0) |
| Latest | 4.0.0 |
| [Available on SPA/Headless](../../../Developing/Templating/Freemarker-vs-headless/#_magnolia_modules_and_features) | Yes |

## [](#_personalization)Personalization

[Personalization](../../../use-cases/Personalization/) refers to adapting content to a particular user according to his or her personal preferences, needs and capabilities. In order to do so, you first select a set of traits of a visitor or a visit, then compose rules using these traits to define what content is presented to which visitors and when.

## [](#_modules)Modules

Magnolia’s Personalization feature consists of the following modules.

-   Blossom-compatibility: Provides personalization of [Blossom](../Blossom-module/) components.

-   Components: Support for creating component variants.

-   Core: Personalization core.

-   Pages: Personalization integration for the Pages app.

-   Personas app: App for creating hypothetical visitors who represent your target audience.

-   [Preview app](../../../Apps/List-of-apps/Preview-app/): App for testing content delivery by impersonating a visitor.

-   REST: [Personalization support for the Delivery API](#rest:api:Requesting-personalized-content-with-the-delivery-endpoint.adoc).

-   Segmentation app: Provides the Segments app for grouping visitors into [segments](../../../Getting-started-with-Magnolia/Glossary/#_segment).

-   Traits: Example traits country, date, cookie and visitor.

-   Widgetset: Widgetset for client-side extensions needed for the variant-selectors.


```xml
<dependency>
  <groupId>info.magnolia.personalization</groupId>
  <artifactId>magnolia-personalization-components</artifactId>
  <version>4.0.0</version> (1)
</dependency>
```

|     |     |
| --- | --- |
| **1** | Should you need to specify the module version, do it using `<version>`. |

```xml
<dependency>
  <groupId>info.magnolia.personalization</groupId>
  <artifactId>magnolia-personalization-core</artifactId>
  <version>4.0.0</version> (1)
</dependency>
```

|     |     |
| --- | --- |
| **1** | Should you need to specify the module version, do it using `<version>`. |

```xml
<dependency>
  <groupId>info.magnolia.personalization</groupId>
  <artifactId>magnolia-personalization-integration</artifactId>
  <version>4.0.0</version> (1)
</dependency>
```

|     |     |
| --- | --- |
| **1** | Should you need to specify the module version, do it using `<version>`. |

```xml
<dependency>
  <groupId>info.magnolia.personalization</groupId>
  <artifactId>magnolia-personalization-pages</artifactId>
  <version>4.0.0</version> (1)
</dependency>
```

|     |     |
| --- | --- |
| **1** | Should you need to specify the module version, do it using `<version>`. |

```xml
<dependency>
  <groupId>info.magnolia.personalization</groupId>
  <artifactId>magnolia-personalization-personas-app</artifactId>
  <version>4.0.0</version> (1)
</dependency>
```

|     |     |
| --- | --- |
| **1** | Should you need to specify the module version, do it using `<version>`. |

```xml
<dependency>
  <groupId>info.magnolia.personalization</groupId>
  <artifactId>magnolia-personalization-preview-app</artifactId>
  <version>4.0.0</version> (1)
</dependency>
```

|     |     |
| --- | --- |
| **1** | Should you need to specify the module version, do it using `<version>`. |

```xml
<dependency>
  <groupId>info.magnolia.personalization</groupId>
  <artifactId>magnolia-personalization-rest</artifactId>
  <version>4.0.0</version> (1)
</dependency>
```

|     |     |
| --- | --- |
| **1** | Should you need to specify the module version, do it using `<version>`. |

```xml
<dependency>
  <groupId>info.magnolia.personalization</groupId>
  <artifactId>magnolia-personalization-segmentation-app</artifactId>
  <version>4.0.0</version> (1)
</dependency>
```

|     |     |
| --- | --- |
| **1** | Should you need to specify the module version, do it using `<version>`. |

```xml
<dependency>
  <groupId>info.magnolia.personalization</groupId>
  <artifactId>magnolia-personalization-traits</artifactId>
  <version>4.0.0</version> (1)
</dependency>
```

|     |     |
| --- | --- |
| **1** | Should you need to specify the module version, do it using `<version>`. |

```xml
<dependency>
  <groupId>info.magnolia.personalization</groupId>
  <artifactId>magnolia-personalization-widget</artifactId>
  <version>4.0.0</version> (1)
</dependency>
```

|     |     |
| --- | --- |
| **1** | Should you need to specify the module version, do it using `<version>`. |

Part of the module is also the `magnolia-personalization-blossom-compatibility`.

> **Caution:** To be able to use personalization in the Delivery API, you should:

1.  Add the Blossom dependency (`magnolia-personalization-blossom-compatibility`) only **if you are using the Blossom modules in your project**:

    ```xml
    <dependency>
      <groupId>info.magnolia.personalization</groupId>
      <artifactId>magnolia-personalization-blossom-compatibility</artifactId>
      <version>4.0.0</version> (1)
    </dependency>
    ```

    |     |     |
    | --- | --- |
    | **1** | Should you need to specify the module version, do it using `<version>`. |

2.  Make sure that in the content of your `pom.xml` for your webapp you include the following two dependencies **if your project is generated from the [Magnolia webapp archetype](../../../Developing/Development-how-tos/How-to-use-Magnolia-Maven-archetypes/)**:

    ```xml
    ...
      <dependencies>
       ...

       <!-- include p13n for rest -->
        <dependency>
            <groupId>info.magnolia.personalization</groupId>
            <artifactId>magnolia-personalization-rest</artifactId>
            <version>2.1.1</version>
        </dependency>

      </dependencies>
    ...
    ```

    > **Caution:** If you use personalization version 2.1.0, you also need to add the following dependencyManagement into your webapp’s pom.xml file....
    > <dependencyManagement>
    >     <dependencies>
    >     <!-- include dependency management for p13n 2.1.0 -->
    >         <dependency>
    >             <groupId>info.magnolia.personalization</groupId>
    >             <artifactId>magnolia-personalization-parent</artifactId>
    >             <version>2.1.0</version>
    >             <type>pom</type>
    >             <scope>import</scope>
    >         </dependency>
    >     </dependencies>
    > </dependencyManagement>
    > ...


## [](#_configuration)Configuration

> **Tip:** See an overview of differences between FreeMarker and headless templating.

### [](#_variant_rendering_restrictions_on_public_instances)Variant rendering restrictions on public instances

Public users cannot preview content variants. When a public user tries to access a variant—either directly or via a link, they see the original page with no variants applied.

A default rendering filter at `/server/filters/cms/rendering` continues to block direct URL access to `mgnl:variant` nodes on public instances for security purposes, returning a `404 not found` response. This doesn’t affect normal page rendering, Delivery API responses, or the Preview app, but means variants cannot be tested via direct URLs.

To test variants, use the [Preview app](../../../Apps/List-of-apps/Preview-app/).

For more information, see [Restricting node type rendering](../../../Administration/Architecture/Request-processing-and-filters/Filters/#_restricting_node_type_rendering).

### [](#_components_submodule)Components submodule

Nested variants occur when a page variant contains component variants. Control the ability for editors to create nested variants using the `allowNestedVariants` property on the module level configuration.

| Node name | Value |
| --- | --- |
| personalization-components |     |
| config |     |
| allowNestedVariants | false |

| Property | Description |
| --- | --- |
| `allowNestedVariants` | **optional**, *default is `false`*<br><br>Allows you to create component variants inside a page variant if set to `true`. |

### [](#_traits_submodule)Traits submodule

Provides out-of-the-box functionality for the following trait types:

-   All name-and-value based traits.

-   Cookie trait.

-   Header trait.

-   Request parameter trait.


## [](#_custom_traits)Custom traits

Each trait has a configuration which can be adjusted. For configuration details, see the [Registering a trait](Creating-custom-traits/#_registering_a_trait) section on Creating custom traits page.

## [](#_issues)Issues

### [](#_missing_countryvoter)Missing CountryVoter

You may encounter the following issue:

```console
2024-09-18 15:30:30,533 WARN  agnolia.transformer.ClassPropertyBasedTypeResolver: Encountered the 'class' property but failed to resolved the type from its value: [info.magnolia.personalization.geoip.CountryVoter]
java.lang.ClassNotFoundException: info.magnolia.personalization.geoip.CountryVoter
```

**Solution**

1.  Add the following dependency to your webapp:

    ```xml
      <dependency>
            <groupId>info.magnolia.personalization</groupId>
            <artifactId>magnolia-personalization-compatibility</artifactId>
            <version>${personalization.version}</version>
      </dependency>
    ```

2.  If needed, copy the related configuration from `/modules/personalization-traits`.


Related topics

-   [Personalization](../../../use-cases/Personalization/)

-   [Component personalization](../../../Features/Personalization/Component-personalization/)

-   [Requesting personalized content with the delivery endpoint](#rest:api:Requesting-personalized-content-with-the-delivery-endpoint.adoc)

-   [Personalization of headless SPA projects](../../../Developing/headless/spa-development/personalization-of-headless-SPA-projects/)

-   [Preview app](../../../Apps/List-of-apps/Preview-app/)

-   [My first personalized campaign](My-first-personalized-campaign/)

-   [Creating custom traits](Creating-custom-traits/)

-   [Creating custom traits without Java](Creating-custom-traits-without-Java/)

-   [Creating custom traits with complex fields](Creating-custom-traits-with-complex-fields/)
