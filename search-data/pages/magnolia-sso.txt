---
title: "SSO module"
url: https://docs.magnolia-cms.com/magnolia-sso/
category: Modules
version: modules
breadcrumb: SSO module
---

# SSO module

| Edition | DX Core |
| --- | --- |
| License | [MLA](https://www.magnolia-cms.com/mla.html) |
| Issues | [MGNLSSO](https://magnolia-cms.atlassian.net/browse/MGNLSSO) |
| Maven site | [SSO](https://nexus.magnolia-cms.com/#browse/browse:enterprise:info%2Fmagnolia%2Fsso%2Fmagnolia-sso%2F6.0.0) |
| Latest | 6.0.0 |

## [](#_installing_with_maven)Installing with Maven

Maven is the easiest way to install the module. Add the following to your [bundle](../product-docs/RNs-6-4-3/Developing/Bundles-and-webapps/):

```xml
<dependency>
  <groupId>info.magnolia.sso</groupId>
  <artifactId>magnolia-sso</artifactId>
  <version>6.0.0</version> (1)
</dependency>
```

|     |     |
| --- | --- |
| **1** | Should you need to specify the module version, do it using `<version>`. |

> **Note:** Depending on your setup, javax dependency issues might occur on start-up, for example:[WARNING] Found duplicate (but equal) classes in [jakarta.inject:jakarta.inject-api:1.0, javax.inject:javax.inject:1]:
> [WARNING]   javax.inject.Inject
> [WARNING]   javax.inject.Named
> [WARNING]   javax.inject.Provider
> [WARNING]   javax.inject.Qualifier
> [WARNING]   javax.inject.Scope
> [WARNING]   javax.inject.Singleton
> [WARNING] Found duplicate classes/resources in compile classpath.You can fix them with the following exclusion dependency in your parent pom.xml file. <dependencyManagement>
>     <dependencies>
>
>       <!-- Magnolia SSO Module -->
>       <dependency>
>         <groupId>info.magnolia.sso</groupId>
>         <artifactId>magnolia-sso</artifactId>
>         <version>${magnolia.sso.version}</version>
>         <exclusions>
>           <!-- Temorarily excluded (replaced by jakarta variant) until fixed in
>                the upstream project. -->
>           <exclusion> (1)
>             <groupId>javax.inject</groupId>
>             <artifactId>javax.inject</artifactId>
>           </exclusion>
>         </exclusions>
>       </dependency>1javax.inject exclusion dependency.

| Prerequisite | Description |
| --- | --- |
| a user | **required** Their username and password are used to access Admincentral. They should have names as well as an email. |
| a group | **required** When the user logs in, they have to belong to at least one group defined in the group mappings. That‚Äôs how the necessary access to Magnolia is granted. ** A user may only belong to a maximum number of 200 groups, including nested groups, for JSON web tokens (JWT). For more information, see [Microsoft group overages](https://learn.microsoft.com/en-us/security/zero-trust/develop/configure-tokens-group-claims-app-roles#group-overages) . | ** | A user may only belong to a maximum number of 200 groups, including nested groups, for JSON web tokens (JWT). For more information, see [Microsoft group overages](https://learn.microsoft.com/en-us/security/zero-trust/develop/configure-tokens-group-claims-app-roles#group-overages) . |
| ** | A user may only belong to a maximum number of 200 groups, including nested groups, for JSON web tokens (JWT). For more information, see [Microsoft group overages](https://learn.microsoft.com/en-us/security/zero-trust/develop/configure-tokens-group-claims-app-roles#group-overages) . |
| an OIDC client | **required** With the following properties: |
| a name | **required** Must be the same as the one used in the YAML configuration of the module. |
| the `openid-connect` protocol | **required** |
| a confidential access type | **required** This is required to generate credentials. |
| credentials | **required** Those must be shared with the YAML configuration of the module. |
| a redirect URI | **required** That points back to Magnolia, e.g. `http://localhost:8080/*` . |
| a Group Membership mapper | **required** By convention, this is required in order to include the user‚Äôs groups in the `groups` property ( info.magnolia.sso.oidc.GroupsAuthorizationGenerator ). Without this data, a user won‚Äôt be assigned any Magnolia permissions, and hence won‚Äôt be able to go past the login screen. Here‚Äôs how to configure the mapper in various applications: ‚Ä¢ []() Okta ‚Ä¢ []() Azure ‚Ä¢ []() Keycloak ** If you leave **Full group path** toggle **On** as shown below, make sure it‚Äôs reflected in your [yaml configuration](#sso-yamlConfig-authGeneratorSection) as the path ( `/group-name` , not just `group-name` ). Otherwise, toggle this option to **Off** and use the group name. | ** | If you leave **Full group path** toggle **On** as shown below, make sure it‚Äôs reflected in your [yaml configuration](#sso-yamlConfig-authGeneratorSection) as the path ( `/group-name` , not just `group-name` ). Otherwise, toggle this option to **Off** and use the group name. |
| ** | If you leave **Full group path** toggle **On** as shown below, make sure it‚Äôs reflected in your [yaml configuration](#sso-yamlConfig-authGeneratorSection) as the path ( `/group-name` , not just `group-name` ). Otherwise, toggle this option to **Off** and use the group name. |

## [](#_sso_user_profile_information)SSO user profile information

User profile preferences related to the Magnolia instance for SSO users is stored in the `profiles` workspace that may only be accessed by the `superuser`.

The following information is stored in the `profiles` workspace for SSO users:

-   Full name

-   Email

-   Favorite apps

-   Language

-   Last login

-   Previous login

-   Timezone

-   Completed intro status (Magnolia app launcher tour)

-   Usage metrics acknowledgement status


> **Tip:** SSO users can set their user preferences for timezone and language in AdminCentral.

The information for each user is stored based on the username from the third-party IdP. If you change a user‚Äôs username in your IdP, their preferences are reset in Magnolia.

| Node name | Value |
| --- | --- |
| ‚∏¨ -.auth |  |
| ‚¨© pattern | /.auth/* ** |

| üìÅ server |  |
| --- | --- |
| üìÅ filters |  |
| üìÅ securityCallback |  |
| ‚∏¨ clientCallbacks |  |
| ‚∏¨ ssoFallback |  |
| ‚¨© class | info.magnolia.cms.security.auth.callback.FormClientCallback |
| ‚¨© loginForm | /defaultMagnoliaLoginForm/login.html |
| ‚∏¨ originalUrlPattern |  |
| ‚¨© class | info.magnolia.cms.util.SimpleUrlPattern |
| ‚¨© **patternString** | `/.magnolia/jcrlogin` |
| ‚¨© enabled | true |
| ‚∏¨ ssoLocationFragmentRedirect |  |
| ‚∏¨ sso |  |

## [](#uri-preservation-domain-redirects-anchor)Preserving Admincentral URLs upon login

[Fragments](../product-docs/6.3/Apps/Developing-an-app/Specific-aspects/Location-location-location/) in a URL are preserved if there‚Äôs no domain redirect during login. This is because fragments are handled in the browser and are never sent to the server. However, when domain changes occur, a redirect happens and fragments aren‚Äôt sent to the server by default. By enabling `magnolia.admincentral.sso.remember-location`, the original request URL including the location fragment is first stored in the browser before the login flow starts, and is restored afterwards upon successful login. This way, users reach the page they want.

magnolia.properties file

```none
magnolia.admincentral.sso.remember-location=true
```

## [](#jaas-config-anchor)Configuring JAAS

Ensure the [JAAS security setup](../product-docs/6.3/Administration/Security/JAAS-security-setup/) configuration is in the `WEB-INF/config/jaas.config` file. The configuration should appear as follows for SSO installations when using both SSO and the optional fallback JCR-based authentication:

JAAS configuration

```java
magnolia { (1)
  info.magnolia.jaas.sp.jcr.JCRAuthenticationModule requisite;
  info.magnolia.jaas.sp.jcr.JCRAuthorizationModule required;
};

sso-authentication { (2)
  info.magnolia.sso.jaas.SsoAuthenticationModule requisite;
  info.magnolia.jaas.sp.jcr.JCRAuthorizationModule required;
};
```

|     |     |
| --- | --- |
| **1** | **Optional** fallback default JCR-based login authentication and authorization |
| **2** | SSO login authentication and authorization |

If you don‚Äôt want to use the fallback default JCR-based login, you can [disable it](#disable-fallback-login-anchor).

| Module version | Third-party APIs tested against | Released with |
| --- | --- | --- |
| `6.0+` | Keycloak `21.1.0` ** See [here](https://www.keycloak.org/2023/04/keycloak-2110-released) for more on Keycloak `21.1.0` . | ** | See [here](https://www.keycloak.org/2023/04/keycloak-2110-released) for more on Keycloak `21.1.0` . | Magnolia CMS `6.4` |
| ** | See [here](https://www.keycloak.org/2023/04/keycloak-2110-released) for more on Keycloak `21.1.0` . |
| `5.0+` | Keycloak `21.1.0` ** See [here](https://www.keycloak.org/2023/04/keycloak-2110-released) for more on Keycloak `21.1.0` . | ** | See [here](https://www.keycloak.org/2023/04/keycloak-2110-released) for more on Keycloak `21.1.0` . | Magnolia CMS `6.4` |
| ** | See [here](https://www.keycloak.org/2023/04/keycloak-2110-released) for more on Keycloak `21.1.0` . |
| `4.0+` | Keycloak `21.1.0` ** See [here](https://www.keycloak.org/2023/04/keycloak-2110-released) for more on Keycloak `21.1.0` . | ** | See [here](https://www.keycloak.org/2023/04/keycloak-2110-released) for more on Keycloak `21.1.0` . | Magnolia CMS `6.3.0` |
| ** | See [here](https://www.keycloak.org/2023/04/keycloak-2110-released) for more on Keycloak `21.1.0` . |
| `3.1.5+` | Keycloak `21.1.0` ** See [here](https://www.keycloak.org/2023/04/keycloak-2110-released) for more on Keycloak `21.1.0` . | ** | See [here](https://www.keycloak.org/2023/04/keycloak-2110-released) for more on Keycloak `21.1.0` . | Magnolia CMS `6.2.36` |
| ** | See [here](https://www.keycloak.org/2023/04/keycloak-2110-released) for more on Keycloak `21.1.0` . |
| `3.1+` | Keycloak `21.0.1` ** See [here](https://www.keycloak.org/2023/03/keycloak-2101-released) for more on Keycloak `21.0.1` . | ** | See [here](https://www.keycloak.org/2023/03/keycloak-2101-released) for more on Keycloak `21.0.1` . | Magnolia CMS `6.2.30` |
| ** | See [here](https://www.keycloak.org/2023/03/keycloak-2101-released) for more on Keycloak `21.0.1` . |
| `3.0+` | Keycloak `16.1.1` ** See [here](https://www.keycloak.org/2022/01/keycloak-1611-released) for more on Keycloak `16.1.1` . | ** | See [here](https://www.keycloak.org/2022/01/keycloak-1611-released) for more on Keycloak `16.1.1` . | Magnolia CMS `6.2.23` |
| ** | See [here](https://www.keycloak.org/2022/01/keycloak-1611-released) for more on Keycloak `16.1.1` . |
| `2.0+` | Azure Active Directory ** We exclusively support the 2.0 version of the endpoint. This means the URL should look like `https://login.microsoftonline.com/‚Ä¶/v2.0/.well-known/openid-configuration` . | ** | We exclusively support the 2.0 version of the endpoint. This means the URL should look like `https://login.microsoftonline.com/‚Ä¶/v2.0/.well-known/openid-configuration` . |  |
| ** | We exclusively support the 2.0 version of the endpoint. This means the URL should look like `https://login.microsoftonline.com/‚Ä¶/v2.0/.well-known/openid-configuration` . |
| `2.0+` | Google Cloud Identity |  |
| `1.1+` | Keycloak 9.0.3 |  |
| `1.1+` | Okta 2021.03.3+ |  |
