---
title: "Security best practices"
url: https://docs.magnolia-cms.com/product-docs/RNs-6-4-3/Administration/Security/Security-best-practices/
category: Magnolia 6.4
version: latest
breadcrumb: DX Core > Administration > Security > Security best practices
---

# Security best practices

## [](#_best_practices_for_a_secure_magnolia_environment)Best practices for a secure Magnolia environment

-   Create a custom user with superuser role and deactivate the `superuser` user as soon as possible after installation.

-   Keep instances up to date.

-   Store public and author databases in separate physical locations. This minimizes the risk of data loss due to hardware failure or breach. The likelihood of a simultaneous event on both instances is less than that of a single instance in a different location. Failing suitable backup data, the surviving instance can be used to restore the instance on which the loss or corruption occurred. This tip is not Magnolia specific, just good common practice.

-   Delegate (move) the JCR repository and all [folders referenced](../../Architecture/Configuration-management/#_defining_properties) from the `magnolia.properties` files outside the webapp.

-   Run your server with a user account that has only read access to the Magnolia webapp. This ensures that a potential attacker can‚Äôt use your write access to create a file with a malicious script for example.

-   Train users to create secure passwords. Thomas Baeddal‚Äôs article [Usability of passwords](http://www.baekdal.com/tips/password-security-usability) covers the subject in depth.

-   Ensure that anonymous access to AdminCentral URLs is blocked on author and public instances. This is the default. Edit the `anonymous` role and create an [ACL](../../IAM/Roles-and-access-control-lists/) that denies access to `./magnolia` and `.magnolia/*`.

-   Alternatively, if or when you‚Äôre not using IP based filtering for access to AdminCentral on `public`, be sure to [restrict access to `./resources` and `.resources/*`](../../../Developing/Resources/#_restricting_access_to_resources).

-   If feasible, block access to the AdminCentral URIs for all users other than those inside the local network.


## [](#_servlet_container_and_web_server_configuration)Servlet container and Web server configuration

-   Set up a SSL or TLS connector for Tomcat for encrypted communication and secure identification. Enable HTTPS for all sites managed in Magnolia. Instructions for [Tomcat](https://tomcat.apache.org/tomcat-9.0-doc/ssl-howto.html) and [Apache Web server](http://httpd.apache.org/docs/current/ssl/ssl_howto.html).

-   Restrict access by IP address or remote host. Instructions for [Tomcat](https://tomcat.apache.org/tomcat-9.0-doc/config/valve.html) and [Apache Web server](http://httpd.apache.org/docs/current/howto/access.html). IP filtering is available also in Magnolia at `/server/IPConfig` where you can configure access based on HTTP method. Apply filtering to single IP addresses or to all IP addresses, indicated by using `*` (asterisk). Regular expressions are not supported.

-   Attach a monitoring tool to your Tomcat instance for a better overview what is happening in the container. Try [Lambda Probe](http://www.lambdaprobe.org/) or other [JMX monitoring](http://wiki.magnolia-cms.com/display/DOCS45/Monitoring#Monitoring-JMXmonitoring) tools.

-   Change the `Server` response header field so it does not tell the version of Apache and operating system you are running. Attackers can use such information to their advantage. [Apache Core: ServerTokens directive](http://httpd.apache.org/docs/current/mod/core.html#servertokens)

-   Disable caching for secure content via no-cache headers. Do this in Magnolia [browser cache policy](../../../Modules/List-of-modules/Cache-modules/Cache-core/#_policy_configuration).

-   Take cache-related [measures that prevent Web Cache Poisoning](../../../Modules/List-of-modules/Cache-modules/Cache-core/#_web_cache_poisoning) attacks.

-   Secure session cookies:

    -   [Enforce HTTPS for JSESSIONID cookies](https://owasp.org/www-community/controls/SecureCookieAttribute) by properly configuring Tomcat for your deployment scenario.

    -   Tomcat automatically sets `httpOnly=true` on session cookies, but the `secure` attribute requires proper configuration based on your setup.

        > **Note:** When Tomcat runs behind a proxy, use RemoteIpValve and ensure your proxy forwards the standard X-Forwarded-* headers. This lets Tomcat reconstruct the original scheme, host and port, so cookies are marked Secure and URLs are generated correctly. If Tomcat isn‚Äôt behind a proxy and is handling client requests directly, you typically don‚Äôt need the valve. For more details, see Configuring Magnolia behind a proxy.If needed, you can explicitly set cookie attributes in the web.xml file, but keep in mind:Tomcat always marks the session cookie as HttpOnly.Tomcat marks it as Secure when the scheme is HTTPS.Setting these via <session-config> is a workaround for proxy setups without a properly configured RemoteIpValve. The recommended approach is to configure the valve so Tomcat interprets the original request as HTTPS and sets Secure automatically.


-   Configure a restrictive Content Security Policy (CSP) for production deployments.

    A restrictive CSP helps protect against Cross-Site Scripting (XSS) and clickjacking attacks by controlling what resources can be loaded on your pages. For more details, see [HTTP headers and security best practices](#_http_headers_and_security_best_practices).


## [](#_importing_content)Importing content

To mitigate the risk of security vulnerabilities when importing content, restrict the use of import commands to trusted users. Limiting who can import files offers another layer of protection to your environment. See [Restricting actions](../../../Apps/App-configuration/Action-bar-definition/#_restricting_actions) for more information.

## [](#_resolving_a_lockout)Resolving a lockout

If you accidentally lock out `superuser` and are unable to access AdminCentral:

-   If you still remember the `superuser` password, use the [Rescue App](../../../Modules/List-of-modules/Groovy-module/#_rescue_app).

-   If you forgot the `superuser` password, see [Reset superuser account](https://magnolia-cms.atlassian.net/wiki/spaces/WIKI/pages/839943452/Reset+superuser+account).

-   If you suspect the lockout is due to errors in recent configuration changes, see [Rescue Security Support](https://wiki.magnolia-cms.com/display/WIKI/Rescue+Security+Support).


| üìÅ server |  |
| --- | --- |
| üìÅ filters |  |
| üìÅ HeaderFilterOne |  |
| ‚¨© class | info.magnolia.cms.filters.AddHeadersFilter |
| ‚¨© enabled | true |
| üìÅ headers |  |
| ‚¨© Content-Security-Policy | default-src `self' `unsafe-inline' `unsafe-eval' [https://ga-dev-tools.appspot.com](https://ga-dev-tools.appspot.com) [https://apis.google.com](https://apis.google.com) [https://www.google.com](https://www.google.com) [https://content.googleapis.com](https://content.googleapis.com) [https://ajax.googleapis.com](https://ajax.googleapis.com) ; img-src `self' data:; |
