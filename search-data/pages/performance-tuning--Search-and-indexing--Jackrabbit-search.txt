---
title: "Jackrabbit search"
url: https://docs.magnolia-cms.com/performance-tuning/Search-and-indexing/Jackrabbit-search/
category: Modules
version: modules
breadcrumb: Performance tuning guide > Search and indexing > Jackrabbit search
---

# Jackrabbit search

By default Magnolia’s search functionality is provided by the Jackrabbit repository and this page describes the configuration options for Jackrabbit-based search. For more advanced search options and especially if you need to manage high volumes of [assets](../../../product-docs/RNs-6-4-3/Authoring/Managing-assets/#_how_to_handle_large_amount_of_assets) you can set up Magnolia to use Apache Solr, see [Solr search](../../../product-docs/RNs-6-4-3/Features/Search/Solr-search/).

## [](#_how_search_indexing_works)How search indexing works

A workspace needs to be indexed in order to make information retrieval fast and accurate. Indexing is the process of collecting and parsing content, and storing the data in an index to make it easier and faster to retrieve requested portions of the data.

Magnolia search is based on the default [Jackrabbit search implementation](http://jackrabbit.apache.org/jcr/search-implementation.html). Jackrabbit uses an [Apache Lucene-based](http://lucene.apache.org/) indexer to process the data stored in the JCR. Node names and property values are indexed immediately and stored in the repository. Text from documents is extracted in a background process which makes document content searchable after a short delay.

Each Magnolia instance has its own repository and its own index. This means that the author instance index is typically different from public instance indexes. Any content that has not been published to a public instance cannot be found when running a search on that public instance.

### [](#_apache_lucene_indexing_configuration)Apache Lucene Indexing Configuration

The Apache Lucene Indexing Configuration lets you specify indexed node properties, assess their impact on search results, and configure analyzers. The [index configuration file](../Search-index-configuration-file/) defines how Lucene indexes a workspace. If a search indexing inconsistency occurs, it might be necessary to [recreate the search index](../../../product-docs/RNs-6-4-3/Administration/Troubleshooting/Repository-inconsistency/#_recreating_search_indexes).

| Node name | Value |
| --- | --- |
| ⸬ tours |  |
| ⬩ repository | tours |
| ⬩ handlePrefix |  |
| ⬩ URIPrefix | /tours/ |

## [](#_customizing_search)Customizing search

You can customize search by writing your own queries to search the index and execute them in code. A query returns a result set which you can display on a page.

Write queries in a language supported by the JCR repository such as SQL-2 ([grammar](http://www.h2database.com/jcr/grammar.html), [examples](http://svn.apache.org/viewvc/jackrabbit/trunk/jackrabbit-spi-commons/src/test/resources/org/apache/jackrabbit/spi/commons/query/sql2/test.sql2.txt?view=markup)).

You can test your queries in the [Query subapp](../../../product-docs/RNs-6-4-3/Apps/List-of-apps/JCR-Tools-app/). When you get the result set you want, implement the query in code.

![Query subapp](../../../product-docs/RNs-6-4-3/_images/6-0-JCR-tools-query-app.png)

### [](#_example_queries)Example queries

The following queries are written in SQL-2. See [JCR Query Cheat Sheet](../../../product-docs/RNs-6-4-3/Developing/Development-how-tos/jcr-query-cheat-sheet/) for more examples.

1.  Find pages that contain the word `swiss`.

    Workspace: `website`

    ```sql
    SELECT * FROM [mgnl:page] AS t WHERE
       ISDESCENDANTNODE([/tours]) AND
       CONTAINS(t.*, 'swiss')
    ```


2.  Find modules that have [commands](../../../product-docs/RNs-6-4-3/Developing/Commands/). This query looks for a folder named `commands` in the module configuration.

    Workspace: `config`

    ```sql
    SELECT * FROM [mgnl:content] AS t WHERE
       ISDESCENDANTNODE([/modules]) AND
       name(t) = 'commands'
    ```


3.  Find assets that are not JPG images under the `/example` path in the DAM.

    Workspace: `dam`

    ```sql
    SELECT * FROM [nt:base] AS t WHERE
       ([jcr:primaryType] = 'mgnl:asset' AND
       [type] <> 'jpg') AND
       ISDESCENDANTNODE([/example])
    ORDER BY [t].title asc
    ```


## [](#_security)Security

Search within Magnolia is access controlled. Search results include only content the user has permission to access. Permissions are controlled through [Security](../../../product-docs/RNs-6-4-3/Administration/Security/). When you execute a query in info.magnolia.context.MgnlContext, contextual factors such as the current user’s permissions are taken into account. If you do not have permission to the items you are querying, they will not show up in the results.
