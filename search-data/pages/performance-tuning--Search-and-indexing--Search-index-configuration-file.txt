---
title: "Search index configuration file"
url: https://docs.magnolia-cms.com/performance-tuning/Search-and-indexing/Search-index-configuration-file/
category: Modules
version: modules
breadcrumb: Performance tuning guide > Search and indexing > Jackrabbit search > Search index configuration file
---

# Search index configuration file

Jackrabbit allows you to control which properties of a node are indexed and how much they affect that node’s `jcr:score` value in the result. You also have the option to configure different analyzers on a property-by-property basis. The index configuration file defines how Lucene indexes the content of a workspace.

> **Note:** Making changes to the JCR search indexing configuration impacts modules that depend on it, including the User Result Ranker module.

## [](#_summary)Summary

Apache Lucene is a Java-based indexing and search technology with spellchecking, hit highlighting, and advanced analysis/tokenization capabilities. This page is based on:

-   [Jackrabbit 2.18 API](http://jackrabbit.apache.org/api/2.18/)

-   [Lucene 3.6](http://lucene.apache.org/core/3_6_0/api/all/index.html?overview-summary.html)


## [](#_indexing_configuration)Indexing configuration

The configuration parameter `indexingConfiguration` isn’t set by default. This means all properties of a node are indexed. To configure the indexing behavior, add a parameter to the `SearchIndex` element in your repository or workspace configuration file.

For more, see [IndexingConfiguration](http://jackrabbit.apache.org/archive/wiki/JCR/IndexingConfiguration_115513411.html).

## [](#_configuration_files)Configuration files

Indexing configuration file should be located in the package info.magnolia.jackrabbit.

-   [indexing\_configuration.xml](https://git.magnolia-cms.com/projects/PLATFORM/repos/main.pub/browse/magnolia-core/src/main/resources/info/magnolia/jackrabbit/indexing_configuration.xml)

-   [indexing\_configuration\_default.xml](https://git.magnolia-cms.com/projects/PLATFORM/repos/main.pub/browse/magnolia-core/src/main/resources/info/magnolia/jackrabbit/indexing_configuration_default.xml)

-   [indexing\_configuration\_website.xml](https://git.magnolia-cms.com/projects/PLATFORM/repos/main.pub/browse/magnolia-core/src/main/resources/info/magnolia/jackrabbit/indexing_configuration_website.xml)

-   [indexing\_configuration\_dam.xml](https://git.magnolia-cms.com/projects/MODULES/repos/dam/browse/magnolia-dam-jcr/src/main/resources/info/magnolia/jackrabbit/indexing_configuration_dam.xml)

-   [indexing\_configuration\_tasks.xml](https://git.magnolia-cms.com/projects/MODULES/repos/task-management/browse/src/main/resources/info/magnolia/jackrabbit/indexing_configuration_tasks.xml)


-   Index Rules

-   Aggregates

-   Analyzers


To optimize the index size, you can index only certain properties of a node type. Index rules are processed top-down, and the first matching rule is applied while all remaining ones are ignored.

> **Note:** As of Jackrabbit 2.0 you can also use the match all regex for the namespace prefix part of a property name. However that’s currently the only supported regular expression. Please note that you must declare the namespace prefixes in the configuration element you use throughout the XML file.

**Node scope and excluding nodes**

With the `nodeScopeIndex` attribute set to `false`, the property is excluded from the full-text index and can’t be queried with `contains(…​)` in SQL or `jcr:contains(…​)` in XPath. Setting `nodeScopeIndex` to `true` includes the property in the full-text index. In both cases, direct property constraints such as `LIKE` or equality remain applicable.

Here, an index rule is applied against nodes of type `nt:base`. The rule also applies to nodes with types that extend from `nt:base`, and so it applies everywhere since `nt:base` is the base node type of all primary node types. To minimize the index and speed-up search, all properties starting with `jcr:` or `mgnl:` are excluded from the index. This means you get fewer results but those results are more relevant.

```xml
<index-rule nodeType="nt:base">
  <property isRegexp="true" nodeScopeIndex="false">mgnl:.*</property> <!-- Exclude Magnolia metadata from the full-text index. -->
  <property isRegexp="true" nodeScopeIndex="false">jcr:.*</property> <!-- Exclude JCR metadata from the full-text index. -->
  <property isRegexp="true">.*:.*</property> <!-- Include all properties from any namespace, even the empty namespace. -->
</index-rule>
```

**Conditions**

You may also add a condition to the index rule and have multiple rules with the same node type.

For example, you only want to boost page titles when the page is marked with a priority property. Furthermore, you are required to provide three priority levels: low, medium, and high.

```xml
<!-- Since the default boost it 1.0 we don't need to specify it. Anything not medium or high will be considered low. -->
<index-rule nodeType="mgnl:page"
            condition="@priority = 'medium'">
  <property boost="3.0">title</property>
</index-rule>
<index-rule nodeType="mgnl:page"
            condition="@priority = 'high'">
  <property boost="5.0">title</property>
</index-rule>
```

**Boost**

Configuring a `boost` value on both nodes or properties that match an index rule is possible. The default `boost` value is `1.0`. Higher `boost` values (a reasonable range is `1.0` to `5.0`) yield a higher score value and appear more relevant.

A `boost` value of `3.0` is added to the `title` property on nodes of type `mgnl:page` in the example below.

```xml
<index-rule nodeType="mgnl:page">
  <property boost="3.0">title</property>
</index-rule>
```

Generally, it can be helpful to include the contents of descendant nodes in a single node to facilitate searching content scattered across multiple nodes.

**Including areas and components**

The configuration uses index aggregates to ensure area and component content is included in the index. The properties of `mgnl:area` and `mgnl:component` comprise most of the page content and must be included explicitly. Nested areas are also included using the `recursive` flag.

The example below creates an index aggregate on `mgnl:page` that includes the content of `mgnl:area` and `mgnl:component`. This makes searching content on a page in one of its area or component subnodes easier.

```xml
<aggregate primaryType="mgnl:page">
  <include primaryType="mgnl:area">*</include>
  <include primaryType="mgnl:component">*</include>
</aggregate>

<!-- areas can be nested -->
<aggregate primaryType="mgnl:area" recursive="true" root="false">  (1)
    <include primaryType="mgnl:component">*</include>
    <include primaryType="mgnl:area">*</include>
</aggregate>
```

|     |     |
| --- | --- |
| **1** | The `root` attribute (default `true`) can be set to `false`. When `false`, the node index is created with only the content it contains, and is used only for nested aggregation (for example in a `mgnl:page`). This helps create a lighter full-text search index. |

With this configuration part, you can define how a property should be analyzed.

For example, if you want to target properties that store German language content with a [German language analyzer](http://lucene.apache.org/core/3_6_0/api/all/org/apache/lucene/analysis/de/GermanAnalyzer.html).

```xml
<analyzer class="org.apache.lucene.analysis.de.GermanAnalyzer">
   <property>text_de</property>
</analyzer>
```

## [](#_custom_configuration_file)Custom configuration file

You can create a custom indexing configuration for any workspace. Once created, the file can be configured in the `workspace.xml` file of the workspace you wish to target. Changes to this configuration require [reindexing the workspace](../../../product-docs/RNs-6-4-3/Administration/Troubleshooting/Repository-inconsistency/).

An example of this is the website specific example above or the [DAM specific configuration](https://git.magnolia-cms.com/projects/MODULES/repos/dam/browse/magnolia-dam-jcr/src/main/resources/info/magnolia/jackrabbit/indexing_configuration_dam.xml).

> **Note:** This DAM example shows node data aggregation. Since the Magnolia metadata is stored in the mgnl:asset node and the image metadata/data is stored in an mgnl:resource subnode, you can aggregate it into one Lucene document.

| Parameter | Description |
| --- | --- |
| `useCompoundFile` | **optional** All files belonging to a segment have the same name with varying extensions. When using the Compound File format, these files are collapsed into a single `.cfs` file. Useful for systems that frequently run out of file handles. |
| `minMergeDocs` | **optional** This setting no longer exists in Lucene 3.x. |
| `volatileIdleTime` | **optional** The Lucene indexer doesn’t write changes to the permanent index immediately. At first, the indexer writes the changes to a volatile index. Once the volatile index reaches a certain size, it’s persisted to the permanent index. Also there is the option to set a timer, in seconds, to control how often changes are written. |
| `maxMergeDocs` | **optional** , *default is Integer.MAX_VALUE* While merging segments, Lucene ensures that no segment with more than `maxMergeDocs` is created. ** We recommend using the default value. A small value doesn’t allow proper index consolidation, which degrades query performance. The default setting ensures segments are merged into fewer, larger ones, making searches faster and more efficient. | ** | We recommend using the default value. A small value doesn’t allow proper index consolidation, which degrades query performance. The default setting ensures segments are merged into fewer, larger ones, making searches faster and more efficient. |
| ** | We recommend using the default value. A small value doesn’t allow proper index consolidation, which degrades query performance. The default setting ensures segments are merged into fewer, larger ones, making searches faster and more efficient. |
| `mergeFactor` | **optional** This value tells Lucene how many documents to store in memory before writing them to the disk, as well as how often to merge multiple segments together. With the default value of 10, Lucene stores 10 documents in memory before writing them to a single segment on the disk. |
| `maxFieldLength` | **optional** Deprecated in Lucene 3.x. |
| `bufferSize` | **optional** Maximum number of documents that are held in a pending queue until added to the index. |
| `cacheSize` | **optional** Size of the document number cache. This cache maps UUIDs to Lucene document numbers. If the doc number cache hits are poor, then increasing this number could help. |
| `maxVolatileIndexSize` | **optional** The maximum volatile index size in bytes until it’s written to disk. The default value is 1MB. |
| `maxHistoryAge` | **optional** The maximum age (in seconds) of the index history. The default value is 0, which means that index commits are deleted as soon as they’re not used anymore. |
| `initializeHierarchyCache` | **optional** With the default value of `true` , the hierarchy cache is initialized on startup and control is only given back when the initialization has completed. When set to `false` , the cache is populated during regular use. |
