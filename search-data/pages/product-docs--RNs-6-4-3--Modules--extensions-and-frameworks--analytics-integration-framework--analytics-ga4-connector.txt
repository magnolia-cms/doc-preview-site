---
title: "Google Analytics 4 extension"
url: https://docs.magnolia-cms.com/product-docs/RNs-6-4-3/Modules/extensions-and-frameworks/analytics-integration-framework/analytics-ga4-connector/
category: Magnolia 6.4
version: latest
breadcrumb: DX Core > Modules > Analytics integration framework > Connecting > Google Analytics 4 extension
---

# Google Analytics 4 extension

Once you have [installed the analytics integration framework](../Analytics-module/), you must connect to your data supplier. This page describes how to connect to a Google Analytics 4 (GA4) data supplier.

You must have an appropriate account and credentials to connect to GA4.

## [](#_licensing)Licensing

The associated framework is included with your DX Core license and is free of charge. However, this extension is paid and requires an additional [special license](../../../../Administration/License/).

## [](#_ga4_account_prerequisites)GA4 account prerequisites

To use GA4 as a data supplier, you need to create a GA4 property and generate a .json format API key.

### [](#_create_a_ga4_property)Create a GA4 property

First, create a GA4 property in your Google Analytics dashboard. You can use [GA4 Property Setup Assistant](https://support.google.com/analytics/answer/9744165?hl=en-GB&utm_id=ad#upgrade&zippy=%2Cin-this-article) for this.

### [](#_generate_a_ga4_api_key)Generate a GA4 API key

You must generate Google Analytics data API key for authentication.

1.  Go to [Quickstart](https://developers.google.com/analytics/devguides/reporting/data/v1/quickstart-client-libraries), and click **Enable the Google Analytics Data API v1**. This will generate a .json file with client configuration. Save the file as `credentials.json`.

    > **Note:** Download and store this private key file carefully; you need it to authenticate Magnolia with Google. Also note the email that’s created in these instructions; you use it in step 4 to give this account access to GA4.

2.  In your organization’s Google Cloud Console, go to **APIs and Services**.

3.  In the **Credentials** section, register the new API key.

4.  Go to **Property access management** and add the `client_email` from the `credentials.json` file to it.

    Example:

    ```json
    {
      "type": "service_account",
      "project_id": "fakeAnalyticsTestProject-234412",
      "private_key_id": "randomId",
      "private_key": "randomKey",
      "client_email": "abc@email.com",
      "client_id": "randomId",
      "auth_uri": "https://accounts.google.com/o/oauth2/auth",
      "token_uri": "https://oauth2.googleapis.com/token",
      "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",
      "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/"
    }
    ```

    ![An example of configuration with an email](../../../../_images/example-config-ga4.png)

    The client email is linking GA4 to collect data.

5.  Back in the Analytics dashboard, go to **Account Settings** and select **Property Access Management**. Add the `client_email` to the list. Once the email has been added, the API key you generated in step 1 can be used.

6.  Switch to Magnolia, and go to the **Resource Files** app. In the action bar, click on **Upload file** and upload the `credentials.json`. Type *“Google”* in the **Name search** to make sure the newly generated `json` file and the supplier `yaml` files are both there.

    ![Resource file list with supplier .yaml and .json key files highlighted](../../../../_images/supplier-json-files.png)

7.  Select the `json` key file from the list and copy the path that appears in the bottom-left corner.

    ![Highlighted location of the path](../../../../_images/json-path.png)

8.  Now, open the *google4supplier* file and paste the path under `serviceAccountJsonPath`.

9.  In the same supplier file, modify the `propertyId` which can be found in your GA account, and click on **Save changes**.


| Property | Description |
| --- | --- |
| `class` | info.magnolia.analytics.google.datasource.GoogleDataSupplier |
| `credentials` | **required** |
| `applicationName` | **required** [Name of the application](https://developers.google.com/api-client-library/java/google-api-java-client/reference/1.20.0/com/google/api/client/googleapis/services/AbstractGoogleClient.Builder#setApplicationName%28java.lang.String%29) requesting the data from the Google Analytics reporting service. For example: Magnolia Analytics |
| `serviceAccountJsonPath` | **required** Path to JSON file with service account credentials for your [Google Analytics Service Account](https://console.developers.google.com/projectselector2/iam-admin/serviceaccounts) . For example: `/analytics-google-connector/analytics/google/private_key.json` . |
| `parameters` | **required** The parameters used in the REST call to configure the JSON results retrieved. These parameters vary depending on the data supplier used. Each parameter is a key-value pair. For Google Analytics, at least the `viewId` parameter is **required** : • Sign in to your [Google Analytics](https://www.google.com/analytics/web/#home/) account • Click **Admin** . • In the `VIEW` column, click **View Settings** . • The **View ID** is under **Basic Settings** . See the [Google Analytics API documentation](https://developers.google.com/analytics/devguides/reporting/core/dimsmets) to find valid parameters for Google Analytics. |
| `filteringSubSetExpression` | **optional** Use to configure segment filtering. |
| `filtersExpression` | **optional** Expression to filter a segment. For example: `ga:pagePath=~%s*` |

| `audienceId` | The numeric identifier of an Audience. Users are reported in the audiences to which they belonged during the report’s date range. Current user behavior doesn’t affect historical audience membership in reports. |
| --- | --- |
| `audienceName` | The given name of an Audience. Users are reported in the audiences to which they belonged during the report’s date range. Current user behavior doesn’t affect historical audience membership in reports. |
| `newVsReturning` | New users have 0 previous sessions, and returning users have 1 or more previous sessions. This dimension returns two values: 'new' or 'returning'. |
| `signedInWithUserId` | The string 'yes' if the user signed in with the User-ID feature. To learn more about User-ID, see [User-ID for cross-platform analysis](https://support.google.com/analytics/answer/9213390) . |

## [](#_google_site_tags)Google site tags

Connected site tags work with an additional `gtag`(`config`, `G-XXXXX`) call (without any parameters), which downloads a Google Analytics 4 tag container and sends an automatic `` page_view` `` event to the Google Analytics 4 property.

Read more about connected site tags in [Set up Analytics](https://support.google.com/analytics/answer/9973999).

## [](#_further_reading)Further reading

-   Google Analytics metrics explorer [https://ga-dev-tools.google/ga4/dimensions-metrics-explorer/](https://ga-dev-tools.google/ga4/dimensions-metrics-explorer/) The Dimensions & Metrics Explorer lists and describes all the dimensions and metrics available through the Core Reporting API.

-   GA Metadata API [https://developers.google.com/analytics/devguides/reporting/data/v1/rest/v1beta/properties/getMetadata](https://developers.google.com/analytics/devguides/reporting/data/v1/rest/v1beta/properties/getMetadata) The Metadata API returns the list and attributes of columns (that is dimensions and metrics) exposed in the Google Analytics reporting APIs. Attributes returned include UI name, description, segments support, and more.
