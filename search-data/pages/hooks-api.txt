---
title: "Hooks API module"
url: https://docs.magnolia-cms.com/hooks-api/
category: Modules
version: modules
breadcrumb: Hooks API module
---

# Hooks API module

| Issues | [HOOKSAPI](https://magnolia-cms.atlassian.net/browse/HOOKSAPI) |
| --- | --- |
| Git | [Git](https://gitlab.magnolia-platform.com/ps/incubator/hooks-api) |
| Latest | 1.0.0 ** Compatible with Magnolia 6.2.27. | ** | Compatible with Magnolia 6.2.27. |
| ** | Compatible with Magnolia 6.2.27. |

## [](#_installing_with_maven)Installing with Maven

Maven is the easiest way to install the module. Add the following to your [bundle](../product-docs/RNs-6-4-3/Developing/Bundles-and-webapps/):

```xml
<dependency>
  <groupId>info.magnolia.workflow</groupId>
  <artifactId>magnolia-hooks-api-integration</artifactId>
  <version>1.0.0</version>
</dependency>
```

## [](#_usage)Usage

To declare a hook, you need to place its yaml configuration file in a module folder named hooks.

### [](#_configuration)Configuration

-   [Hook based on command](#_hook_based_on_command)

-   [Hook based on REST client](#_hook_based_on_rest_client)

-   [Hook triggers](#_hook_triggers)


#### [](#_hook_based_on_command)Hook based on command

```yaml
class: info.magnolia.workflow.hooks.core.definition.CommandBasedHookDefinition (1)
description: Do something after the publication of a page
catalog: default
commandName: dummyCommand
enabled: true #Default: true
asynchronous: true  #Default: true
trigger:
  nodeType: mgnl:page
  actions:
    - PUBLISH
```

|     |     |
| --- | --- |
| **1** | Use the `CommandBasedHookDefinition` to delegate the execution of the hook to a Magnolia command. |

#### [](#_hook_based_on_rest_client)Hook based on REST client

```yaml
class: info.magnolia.workflow.hooks.integration.definition.RestClientBasedHookDefinition (1)
description: Do something after the publication of a page
restClientName: hookSamplesClient
restCallName: postWithBodyParam
trigger:
  nodeType: mgnl:page
  actions:
    - PUBLISH
```

|     |     |
| --- | --- |
| **1** | Use the `RestClientBasedHookDefinition` to delegate the execution of the hook to a Magnolia Rest Client. |

#### [](#_hook_triggers)Hook triggers

Trigger a hook by:

nodeType

```yaml
...
trigger:
  nodeType: mgnl:page (1)
  actions:
    - PUBLISH
```

|     |     |
| --- | --- |
| **1** | Triggers by `nodeType`. |

workspace

```yaml
...
trigger:
  workspace: website (1)
  actions:
    - PUBLISH
```

|     |     |
| --- | --- |
| **1** | Triggers by an entire `workspace`. |

## [](#_integration)Integration

This page provides assistance in integrating the Hooks API module.

### [](#_extension_points)Extension points

By default, the module extends the following commands by chaining an additional hook command:

-   Default publish

-   Default unpublish

-   Versioned publish

-   Versioned unpublish


> **Note:** In addition, it extends the reviewForPublication and the reviewForUnpublication workflows by opening different slots.

![workflow](_images/workflow.jpg)

#### [](#_available_extension_points)Available extension points

The following extensions points are available:

-   `SUBMIT_PUBLISH`: When an editor places a publication request (worklow based publication only).

-   `REJECT_PUBLISH`: When a publisher rejects a publication request (worklow based publication only).

-   `ABORT_PUBLISH`: When a publisher aborts a publication request (worklow based publication only).

-   `PUBLISH`: When a publication request is successfully executed.

-   `SUBMIT_UNPUBLISH`: When an editor places a depublication request (worklow based publication only).

-   `REJECT_UNPUBLISH`: When a publisher rejects a depublication request (worklow based publication only).

-   `ABORT_UNPUBLISH`: When a publisher aborts a depublication request (worklow based publication only).

-   `UNPUBLISH`: When a depublication request is successfully executed.


### [](#_hook_context)Hook context

Every hook will be provided with a context containing the following values:

-   `action`: The hook action.

-   `definition`: The hook definition.

-   `user`: The user.

-   `workspace`: The JCR workspace.

-   `path`: The JCR node path.

-   `jcrId`: The JCR node id.

-   `data`: All the attributes passed to the command or the work item.

-   `jcrNode`: The JCR node.

-   `workItem`: The current workflow work item (worklow based publication only).


### [](#_develop_your_own_command)Develop your own command

If you do not need any custom command input parameter, you can use `CommandBasedHookDefinition` directly. Otherwise, start with implementing your own definition:

```java
@Data
public class DummyCommandDefinition extends CommandBasedHookDefinition {
    /** Input parameter. */
    private String input;
}
```

#### [](#_define_your_hook_by_custom_definition)Define your hook by custom definition

```yaml
class: info.magnolia.workflow.hooks.definition.DummyCommandDefinition
description: Do something after the publication of a page
catalog: default
commandName: dummyCommand
input: Hello
trigger:
  nodeType: mgnl:page
  actions:
    - PUBLISH
```

#### [](#_implement_custom_logic_with_your_custom_command)Implement custom logic with your custom command

```java
public class DummyCommand extends HookCommand<DummyCommandDefinition> { (1)
    /** Message manager. */
    private final MessagesManager messagesManager;

    @Inject
    public DummyCommand(MessagesManager messagesManager) {
        this.messagesManager = messagesManager;
    }

    @Override
    public boolean execute(Context context) throws Exception {
        this.messagesManager.sendRoleMessage("superuser",
                new Message(MessageType.INFO, "Dummy command", getDefinition().getInput()));

        return true;
    }
}
```

|     |     |
| --- | --- |
| **1** | Your custom command. |

### [](#_use_a_rest_client)Use a REST client

```yaml
class: info.magnolia.workflow.hooks.integration.definition.RestClientBasedHookDefinition
description: Perform a dummy post with query and path param after publication
restClientName: hookSamplesClient (1)
restCallName: postWithQueryAndPathParam (2)
trigger:
  workspace: website
  actions:
    - SUBMIT_PUBLISH
```

|     |     |
| --- | --- |
| **1** | Provide the `restClientName` to execute. |
| **2** | Provide the `restCallName` to execute. |

> **Note:** In the REST client configuration, under thedefaultValuesproperty, you need to provide the value expression allowing the system to match the related context value.defaultValues.baseUrl: http://localhost:8080/.rest/hook/demo
> restCalls:
>   postWithQueryAndPathParam:
>     method: POST
>     entityClass: javax.ws.rs.core.Response
>     path: /postWithQueryAndPathParam/{workspace}
>     headers:
>       Content-Type: "application/json; charset=UTF-8"
>     queryParameters:
>       path:  "{path}"
>     defaultValues:
>       workspace: context.mgnlData.repository
>       path:  context.mgnlData.pathFind more examples here.

### [](#_create_your_own_extension_point)Create your own extension point

Let’s say you have a custom action to add a contact. You’ll need to create it and add it to your playbook.

1.  Create your custom extension point.

    ```java
    public class AddContactAction<D extends ActionDefinition> extends AbstractAction<D> {
        private final HookProcessor hookProcessor;

        @Inject
        public AddContactAction(HookProcessor hookProcessor) {
            this.hookProcessor = hookProcessor;
        }

        @Override
        public void execute() throws ActionExecutionException {
            // Create your hook context
            Context hookContext = new HookContextBuilder()
                    .action("ADD_CONTACT")
                    .workspace(...)
                    .path(...)
                    .jcrId(...)
                    .user(...)
                    .attributes(...)
                    .build();

            this.hookProcessor.execute(this.getJCRNode(), "ADD_CONTACT", hookContext);

            return true;
        }

    }
    ```

2.  Add the extension point to your playbook.

    ```yaml
    class: info.magnolia.workflow.hooks.definition.DummyCommandDefinition
    description: Do something after the publication of a page
    catalog: default
    commandName: dummyCommand
    input: Hello
    trigger:
      nodeType: mgnl:page
      actions:
        - ADD_CONTACT
    ```


| Version | Notes |
| --- | --- |
| `1.0.0` | Initial release. |
