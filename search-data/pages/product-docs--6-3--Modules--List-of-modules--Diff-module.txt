---
title: "Diff module"
url: https://docs.magnolia-cms.com/product-docs/6.3/Modules/List-of-modules/Diff-module/
category: Magnolia 6.3
version: 6.3
breadcrumb: DX Core > Modules > Diff module
---

# Diff module

| Edition | DX Core |
| --- | --- |
| License | [MLA](https://www.magnolia-cms.com/mla.html) |
| Issues | [MGNLDIFF](https://magnolia-cms.atlassian.net/browse/MGNLDIFF) |
| Maven site | [Diff](https://nexus.magnolia-cms.com/#browse/browse:enterprise:info%2Fmagnolia%2Fdiff%2Fmagnolia-diff%2F{magnolia-diff-63}) |
| Latest | {magnolia-diff-63} |
| [Available on SPA/Headless](../../../../RNs-6-4-3/Developing/Templating/Freemarker-vs-headless/#_magnolia_modules_and_features) | No |

## [](#_installing_with_maven)Installing with Maven

Maven is the easiest way to install the module. Add the following to your [bundle](../../../../RNs-6-4-3/Developing/Bundles-and-webapps/):

```xml
<dependency>
  <groupId>info.magnolia.diff</groupId>
  <artifactId>magnolia-diff</artifactId>
  <version>{magnolia-diff-63}</version> (1)
</dependency>
```

|     |     |
| --- | --- |
| **1** | Should you need to specify the module version, do it using `<version>`. |

For integration with the Pages app there is also `magnolia-diff-pages-integration`.

```xml
<dependency>
  <groupId>info.magnolia.diff</groupId>
  <artifactId>magnolia-diff-pages-integration</artifactId>
  <version>{magnolia-diff-63}</version> (1)
</dependency>
```

|     |     |
| --- | --- |
| **1** | Should you need to specify the module version, do it using `<version>`. |

> **Warning:** Note the changes in groupId and artifactId since the 2.0 release.

### [](#_compatibility_module)Compatibility module

We have been gradually removing the old Content API from our modules since Magnolia 5.6. If you have custom code relying on classes from the old diff module then you must do one of two things:

-   Update your code for the [new version of the diff module](https://magnolia-cms.atlassian.net/browse/MGNLDIFF-97).

-   Or you can use the `magnolia-diff-compatibility` module together with the `magnolia-core-compatibility` module.


Add the following snippet to your POM file:

```xml
<dependency>
  <groupId>info.magnolia.diff</groupId>
  <artifactId>magnolia-diff-compatibility</artifactId>
  <version>{magnolia-diff-63}</version> (1)
</dependency>
```

|     |     |
| --- | --- |
| **1** | Should you need to specify the module version, do it using `<version>`. |

## [](#_configuration)Configuration

In most circumstances, the Diff module requires no configuration.

However, [version comparison](../../../Apps/Developing-an-app/Specific-aspects/Enabling-versioning-in-content-apps/) relies on functionality provided by the Diff module and, if implemented, may require the following configuration.

### [](#_diff_servlet)Diff servlet

info.magnolia.module.diff.VersionDiffHtmlServlet is registered in the Magnolia [filter chain](../../../Administration/Architecture/Request-processing-and-filters/Filters/) in the **Configuration** app > `/server/filters/servlets/VersionDiffHtmlServlet`. The controller generates the diff view between two versions of a page by checking the `toVersionNr` and `fromVersionNr` request parameters.

![Diff servlet configuration](../../../../RNs-6-4-3/_images/ADVT-diff-servlet.png)

### [](#_diff_configuration)Diff configuration

The default settings for headers, cookies, host and port can be set by configuration.

By default Magnolia is set to generate a JSESSIONID cookie. This is configured in the `diff` module in the **Configuration** app > `/modules/diff/config/cookies`.

![Diff configuration](../../../../RNs-6-4-3/_images/ADVT-diff-config.png)

You can configure custom settings for:

-   `cookies`: You can specify any number of custom session cookie names to forward.

-   `headers`: The default value is `none`. By adding a `headers` config node you can specify any number of headers to be sent to the [diff servlet](#_diff_servlet) thereby automatically excluding any headers that are not specified.

-   `host` and `port` : The default host and port is `localhost` and `8080`. However, the Diff module will work even if you change the default Tomcat port. This means that you can use the diff functionality against another server.


> **Warning:** Due to a security issue, the functionality of host and port is no longer available in Magnolia 6.2.38.

> **Important:** Headers and cookies are configured separately.

![Headers and cookies configuration](../../../../RNs-6-4-3/_images/ADVT-diff-cookies.png)

### [](#_diff_html_generator)Diff HTML generator

info.magnolia.module.diff.VersionDiffHtmlGenerator compares two HTML files using [`HTMLDiffer`](http://code.google.com/p/daisydiff/source/browse/trunk/daisydiff/src/java/org/outerj/daisy/diff/html/HTMLDiffer.java?r=143) and returns HTML that highlights the differences between the compared pages:

-   The comparison only includes the body of the HTML document.

-   The differences are marked with span tags.

-   The header is taken from the HTML of the page that is compared to.

-   CSS is added.


Here’s a snippet from `diff.css` ([Gitlab](https://gitlab.magnolia-platform.com/pd/enterprise/diff/-/blob/master/magnolia-diff/src/main/resources/mgnl-resources/diff-view/css/diff.css)) located in the `mgnl-resources` folder of the module jar.

/\*
 \* Styles for the HTML Diff
 \*/
span.diff-html-added {
    font-size: 100%;
    background-color: #ccffcc; /\* light green \*/
    cursor: pointer;
}
span.diff-html-removed {
    font-size: 100%;
    text-decoration: line-through;
    background-color: #fc6f6f; /\* light red \*/
    cursor: pointer;
}
span.diff-html-changed {
    background-color: #95c6fd; /\* light blue \*/
    cursor: pointer;
}
span.diff-html-selected {
    background-color: #FF8800; /\* light orange \*/
    cursor: pointer;
}

### [](#_diff_utility_classes)Diff utility classes

Two utility classes are provided:

-   info.magnolia.module.diff.util.DiffUtil provides the `buildComparisonURL`, `buildComparisonURLToCurrent` and `buildComparisonURLToCurrentUnversioned` methods.

-   info.magnolia.module.diff.util.VersionComparison is a POJO that `gets` and `sets` the `versionFrom` and `versionTo` methods.


### [](#_compare_actions)Compare actions

info.magnolia.module.diff.app.action.CompareLocalizedVersionsAction and info.magnolia.module.diff.app.action.CompareToPreviousLocalizedVersionAction open the [diff subapp](#_diff_subapp) (see below) configured in the **Pages** app. The action definitions are configured in the **Configuration** app > `/modules/pages/apps/pages/subApps/browser/actions`.

![Compare actions configuration](../../../../RNs-6-4-3/_images/ADVT-diff-compare.png)

### [](#_diff_subapp)Diff subapp

The diff view that opens when comparing different page versions is configured in the **Pages** app. This configuration is in the **Configuration** app > `/modules/pages/apps/pages/subApps/diff`.

-   `class`: info.magnolia.ui.framework.app.embedded.EmbeddedPageSubAppDescriptor embeds the page in an iframe.

-   `label`: Renders in the subapp tab.

-   `subAppClass`: info.magnolia.ui.framework.app.embedded.EmbeddedPageSubApp is the main tab in an embedded page app.


![Diff subapp configuration](../../../../RNs-6-4-3/_images/ADVT-diff-subapp.png)

**Example:** Here’s the `diff` subapp for the `/travel/about/what-we-believe` page. The URL is:

http://localhost:8080/magnoliaAuthor/.magnolia/admincentral#app:pages:diff;/.magnolia/versionDiff?diffViewContentHandle=/travel/about/what-we-believe&fromVersionNr=1.0&toVersionNr=1.1&diffLocale=en

Note the reference to the `diffViewContentHandle`, `fromVersionNr`, and `toVersionNr` parameters.

> **Note:** Restoring a previous version does not restore the name or location (path) of the item if these have been changed.
