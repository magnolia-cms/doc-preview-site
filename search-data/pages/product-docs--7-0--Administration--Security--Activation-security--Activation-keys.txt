---
title: "Activation keys"
url: https://docs.magnolia-cms.com/product-docs/7.0/Administration/Security/Activation-security/Activation-keys/
category: Magnolia 6.4
version: latest
breadcrumb: DX Core > Administration > Security > Publishing security > Activation keys
---

# Activation keys

This page describes the function of activation keys in Magnolia, what they’re used for, possible reasons for their replacement and how to overcome issues which may occur during the replacement process.

> **Tip:** In Magnolia 6.2.44 and later, the Password Manager module key pair is no longer linked to the activation key pair described on this page.

## [](#_understanding_activation_keys_and_their_functions)Understanding activation keys and their functions

Magnolia uses a pair of keys for the [publishing](../../../../../RNs-6-4-3/Administration/Architecture/Publishing/) process.

> **Note:** Activation is used here as a technical term for publishing content from an author instance to public instances. Both the private key and the public key are involved in this process.

### [](#_magnolia_activation_keypair_properties)`magnolia-activation-keypair.properties`

Both keys are stored in a file called `magnolia-activation-keypair.properties` in the filesystem. The path to this file is configured in the Magnolia [property](../../../../../RNs-6-4-3/Administration/Architecture/Configuration-management/#_properties) `magnolia.author.key.location`. The file and the keys are created during the installation of a Magnolia author instance.

### [](#_private_key)Private key

The private is present only in the `magnolia-activation-keypair.properties` file.

### [](#_public_key)Public key

The public key is stored also in the `config` JCR workspace at `/server/activation@publicKey`.

#### [](#_on_the_author_instance)On the author instance

On the author instance, the public key is copied to the `config` workspace during the installation phase.

#### [](#_on_the_public_instance)On the public instance

Immediately after the installation of Magnolia, a public instance doesn’t have a public key yet. The public key is sent to the public instance with the first publishing process.

### [](#_cooperation_of_the_keys_during_publishing)Cooperation of the keys during publishing

During the publishing process, the keys work together. On the author instance, both the private and the public keys are used to encrypt and sign publication packages. On the public instance, the public key is required to decrypt the incoming publication package.

> **Note:** Publishing requires to have the same public key on the author and on the public instances.If there already is a public key on the public instances, and if you re-generate the key on the author instance, publishing will no longer work. (See regenerating the keys.)If you need to regenerate the key pair, you must propagate the public key to the public instances.

| Property | Description |
| --- | --- |
| `magnolia.cipher.algorithm` | **optional** , *default is RSA/NONE/OAEPWithSHA3-256AndMGF1Padding* The cipher algorithm if encryption needs to be used, for example for passwords. It is set to `RSA/NONE/OAEPWithSHA3-256AndMGF1Padding` in the bundle by default since [Magnolia 6.2.37](#6.2@product-docs:ROOT:Releases/Release-notes-for-Magnolia-CMS-6.2.37/Magnolia-6.2.37-known-issues.adoc#_existing_passwords_created_on_previous_versions_are_not_working_in_6_2_37) . |
| `magnolia.signature.algorithm` | **optional** , *default is SHA256withRSA* Sets the signature algorithm. This algorithm is used to sign authorization headers for publication requests between author and public instances. Its value can be for RSA cryptosystem `SHA256withRSA` or for EC cryptography `SHA256withECDSA` . ** The `magnolia.signature.algorithm` property introduces a new header `X-magnolia-act-auth-signature` which you should bear in mind when connecting to AWS gateways. | ** | The `magnolia.signature.algorithm` property introduces a new header `X-magnolia-act-auth-signature` which you should bear in mind when connecting to AWS gateways. |
| ** | The `magnolia.signature.algorithm` property introduces a new header `X-magnolia-act-auth-signature` which you should bear in mind when connecting to AWS gateways. |
| `magnolia.publishing.authentication.signature.enabled` | **optional** , *default is true* If this property is set to `false` , the signature algorithm isn’t used for authentication, and only publishing requests from localhost are allowed. You must add it on both author and public instances with the same value when set. ** In some deployments where you disable this property due to a safe publishing endpoint, you must also disable the following voter: `/server/filters/multipartRequest/bypasses/notAuthenticatedOrInDevelopMode/voters/isNotSignedPublicationRequest/voters/isSigned` . This voter checks whether incoming publication requests have a valid signature. When you disable signature authentication, the author instance no longer signs publication requests, so the `isSigned` voter rejects them. Disabling this voter allows unsigned publication traffic through the filter. | ** | In some deployments where you disable this property due to a safe publishing endpoint, you must also disable the following voter: `/server/filters/multipartRequest/bypasses/notAuthenticatedOrInDevelopMode/voters/isNotSignedPublicationRequest/voters/isSigned` . This voter checks whether incoming publication requests have a valid signature. When you disable signature authentication, the author instance no longer signs publication requests, so the `isSigned` voter rejects them. Disabling this voter allows unsigned publication traffic through the filter. |
| ** | In some deployments where you disable this property due to a safe publishing endpoint, you must also disable the following voter: `/server/filters/multipartRequest/bypasses/notAuthenticatedOrInDevelopMode/voters/isNotSignedPublicationRequest/voters/isSigned` . This voter checks whether incoming publication requests have a valid signature. When you disable signature authentication, the author instance no longer signs publication requests, so the `isSigned` voter rejects them. Disabling this voter allows unsigned publication traffic through the filter. |
| `magnolia.keygen.algorithm` | **optional** , *default is RSA* Specifies the properties used by the system for key pair generation. You can set it to `RSA` or `EC` . |
| `magnolia.keygen.key.length` | **optional** , *default is 4096* For the RSA signature mechanism, specifies the key length. You should only change this property if the RSA algorithm is used for publication. |
| `magnolia.keygen.ec.curve.name` | **optional** , *default is prime256v1* For the EC signature mechanism, specifies the curve name. You should only change this property if the EC algorithm is used for publication. |

## [](#_when_and_how_to_create_new_keys)When and how to create new keys

> **Warning:** As long as your system isn’t compromised, don’t create new keys.Only if your system running the author instance is corrupted, regenerate the key pair on the author instance and propagate the new public key to the public instances.

### [](#_regenerating_the_key_pair)Regenerating the key pair

> **Warning:** Create a new key pair only if it’s necessary!If you already have a public key on the author instances, and if you regenerate the key pair afterward, your system gets into a state where you can no longer publish any content. This means that you can’t publish the newly generated key either!Propagate the new public key to the public instance as soon as possible.

The re-creation of the key pair must be done on the author instance.

1.  Go to AdminCentral.

2.  Open the **Publishing Tools** app.

    ![click publishing tools app](../../../../../RNs-6-4-3/_images/admincentral/administration/click-publishing-tools-app.jpg)

3.  Click on **Generate new key**.

    ![publishing tools app click generate new key](../../../../../RNs-6-4-3/_images/admincentral/administration/publishing-tools-app_click-generate-new-key.jpg)

    The system creates both keys and stores them in the `magnolia-activation-keypair.properties` file. In addition, the system stores the public key in the author system’s JCR.


### [](#_replacing_the_public_key_on_the_public_instances)Replacing the public key on the public instances

Using DX Cloud?

When using DX Cloud, the keys are automatically distributed to the public instance with the help of a dedicated [sidecar](../../../../../../paas/architecture/#_kubernetes_and_sidecars).

The following options are for DX-Core users.

If you have an old public key on the public instances after you have regenerated new keys on the author instance, your system is in a state where you can’t publish content. If this situation arises, there are two ways to propagate the new public key to the public instances:

-   Option I: Copy the `/server/activation@publicKey` property, stored in the `config` workspace, from the author instance to each public instance.

-   Option II: Delete the `/server/activation@publicKey` property in the `config` workspace on every public instance.


In both cases, publishing will work again. Using Option II, the new public key is transferred to the public instances during the first publishing after the deletion of the property.

> **Warning:** The Option II can be considered less secure. As long as there is no public key on the public instance, in theory, an unauthorized publishing of content by somebody else could take place. If you choose Option II, you should carry out a publication immediately after the deletion.

You can delete or set the `publicKey` property on the `/server/activation` node in the `config` workspace:

-   Manually via the [Configuration app](../../../../../RNs-6-4-3/Apps/List-of-apps/Configuration-app/).

-   Via REST, which is explained in the next section.


#### [](#_replacing_the_public_key_on_public_instances_via_rest)Replacing the public key on public instances via REST

For the deletion option, you can use the Magnolia [Properties API](../../../../../RNs-6-4-3/Developing/API/Nodes-and-properties-APIs/Properties-API/). This approach can be handy if you want to create scripts to replace the public key on your author instances without the need of logging in the AdminCentral UI of public instances.

We assume that you have read and understood [REST security](../../../../../RNs-6-4-3/Modules/List-of-modules/REST-module/REST-security/).

This said, the following shows what a REST call done with `cURL` could look like:

```sh
curl -X DELETE https://public1.example.com/.rest/properties/v1/config/server/activation/publicKey \
--user johns-user-name:johns-secret-password
```

```sh
curl -X DELETE http://localhost:8080/magnoliaPublic/.rest/properties/v1/config/server/activation/publicKey \
--user superuser:superuser
```

-   WARNING: Always use SSL/HTTPS for REST calls containing a username and password!

-   The user who executes a REST call also needs:

    -   [JCR Write permissions](../../../../../RNs-6-4-3/Modules/List-of-modules/REST-module/REST-security/#_jcr_access) for the `config` workspace and the `/server/activation` path.

    -   [Web access](../../../../../RNs-6-4-3/Modules/List-of-modules/REST-module/REST-security/#_web_access) (GET & POST) for the `/.rest/properties/v1/config/server/activation` path.


-   If you have more than one public instance, you must execute the REST call on each public instance.

-   **Publish some content immediately** after key deletion to enforce the propagation of the new public key from the author instance to the public instances. You can do this also via REST by utilizing the [Commands API](../../../../../RNs-6-4-3/Developing/API/Commands-API/).


Further tips:

-   With [bash](https://en.wikipedia.org/wiki/Bash_%28Unix_shell%29) or [python](https://www.python.org/) you can merge multiple REST calls into one script.

-   To automate things: Create a distinct user and a distinct role granting the user the required JCR write permissions and Web access for the REST calls.

-   Add/apply further security layer(s) on Apache or at a network level to restrict the REST calls – for example – to more specific paths such as:

    -   `/<domain>/.rest/properties/v1/config/server/activation`

    -   `/<domain>/.rest/nodes/v1/config/server/activation`


-   Add/apply subnet-based or IP range based restrictions.


## [](#_for_legacy_cloud_users)For Legacy cloud users

> **Important:** The following sections are for Legacy Cloud only and not DX Cloud documentation.

### [](#_magnolia_cloud_customers)Magnolia Cloud customers

If you are running a [cloud](../../../../../../cloud/) installation managed by Magnolia, Magnolia is responsible for the integrity of the system. In this case you have no obligation to regenerate the keys. If you have accidentally created a new key pair on an author instance, please contact [Cloud Help Desk](https://jira.magnolia-cms.com/servicedeskcustomer/portal/6/group/18) as soon as possible.

### [](#_custom_cloud_solutions)Custom cloud solutions

If you manage your own, custom-built cloud solution to run a Magnolia installation, we highly recommend, within the possibilities of your infrastructure, setting up an automated system to replace the public key on your public instances.

The [Client Hosted Magnolia offer](../../../../../RNs-6-4-3/Getting-started-with-Magnolia/) does not provide a one-click, out-of-the-box solution to replace the public keys on the author instances.

> **Tip:** See Replacing the public key on public instances via REST for inspiration.
